import{_ as ye}from"./post-item.52a7ee1a.js";import{_ as be}from"./post-skeleton.57669f76.js";import{E as Ce,k as G,cd as ke,c as K,a as xe,e as M,d as A,u as Y,x as U,r as m,y as E,bc as Be,h as P,ag as Fe,bd as Ee,q as Se,ce as De,bp as $e,m as R,bE as Te,z as N,A as Re,ai as O,W as y,a6 as z,a5 as p,Z as C,a4 as i,a9 as S,aa as $,cf as ze,_ as Z,K as W,bA as J,cg as Ae,ch as Ie,ci as Pe,S as Ue,a2 as Oe,af as We,Y as F,aj as Le,cj as je,a3 as D,a7 as T,ab as qe,ac as Me,$ as Ne,cc as Ve,ck as He,cl as Ge,ae as Ke,ao as Ye,c4 as Ze,c7 as Je,c9 as Qe,ca as Xe}from"./index.083ec6de.js";import{c as en,a as nn,_ as tn}from"./Skeleton.ae0af7f1.js";import{_ as Q}from"./Alert.cde2ee0c.js";import{_ as sn}from"./main-nav.5bb9b19f.js";import{M as an}from"./MoreHorizFilled.b64cd0f3.js";import{_ as on}from"./List.79cdd3a1.js";import{_ as ln}from"./Pagination.e4391286.js";import"./content.91fb0c4f.js";import"./formatTime.e07969bb.js";import"./Thing.2da2b8ce.js";const un=Ce({name:"Ellipsis",common:G,peers:{Tooltip:ke}});var rn=un,cn=K("ellipsis",{overflow:"hidden"},[xe("line-clamp",`
 white-space: nowrap;
 display: inline-block;
 vertical-align: bottom;
 max-width: 100%;
 `),M("line-clamp",`
 display: -webkit-inline-box;
 -webkit-box-orient: vertical;
 `),M("cursor-pointer",`
 cursor: pointer;
 `)]);function V(e){return`${e}-ellipsis--line-clamp`}function H(e,l){return`${e}-ellipsis--cursor-${l}`}const dn=Object.assign(Object.assign({},U.props),{expandTrigger:String,lineClamp:[Number,String],tooltip:{type:[Boolean,Object],default:!0}});var X=A({name:"Ellipsis",inheritAttrs:!1,props:dn,setup(e,{slots:l,attrs:r}){const{mergedClsPrefixRef:t}=Y(e),u=U("Ellipsis","-ellipsis",cn,rn,e,t),n=m(null),c=m(null),f=m(null),d=m(!1),o=E(()=>{const{lineClamp:a}=e,{value:_}=d;return a!==void 0?{textOverflow:"","-webkit-line-clamp":_?"":a}:{textOverflow:_?"":"ellipsis","-webkit-line-clamp":""}});function v(){let a=!1;const{value:_}=d;if(_)return!0;const{value:g}=n;if(g){const{lineClamp:B}=e;if(k(g),B!==void 0)a=g.scrollHeight<=g.offsetHeight;else{const{value:I}=c;I&&(a=I.getBoundingClientRect().width<=g.getBoundingClientRect().width)}x(g,a)}return a}const h=E(()=>e.expandTrigger==="click"?()=>{var a;const{value:_}=d;_&&((a=f.value)===null||a===void 0||a.setShow(!1)),d.value=!_}:void 0);Be(()=>{var a;e.tooltip&&((a=f.value)===null||a===void 0||a.setShow(!1))});const w=()=>P("span",Object.assign({},Ee(r,{class:[`${t.value}-ellipsis`,e.lineClamp!==void 0?V(t.value):void 0,e.expandTrigger==="click"?H(t.value,"pointer"):void 0],style:o.value}),{ref:"triggerRef",onClick:h.value,onMouseenter:e.expandTrigger==="click"?v:void 0}),e.lineClamp?l:P("span",{ref:"triggerInnerRef"},l));function k(a){if(!a)return;const _=o.value,g=V(t.value);e.lineClamp!==void 0?b(a,g,"add"):b(a,g,"remove");for(const B in _)a.style[B]!==_[B]&&(a.style[B]=_[B])}function x(a,_){const g=H(t.value,"pointer");e.expandTrigger==="click"&&!_?b(a,g,"add"):b(a,g,"remove")}function b(a,_,g){g==="add"?a.classList.contains(_)||a.classList.add(_):a.classList.contains(_)&&a.classList.remove(_)}return{mergedTheme:u,triggerRef:n,triggerInnerRef:c,tooltipRef:f,handleClick:h,renderTrigger:w,getTooltipDisabled:v}},render(){var e;const{tooltip:l,renderTrigger:r,$slots:t}=this;if(l){const{mergedTheme:u}=this;return P(Fe,Object.assign({ref:"tooltipRef",placement:"top"},l,{getDisabled:this.getTooltipDisabled,theme:u.peers.Tooltip,themeOverrides:u.peerOverrides.Tooltip}),{trigger:r,default:(e=t.tooltip)!==null&&e!==void 0?e:t.default})}else return r()}});function _n(){const e=Se(De,null);return e===null&&$e("use-dialog","No outer <n-dialog-provider /> founded."),e}const pn=e=>{const{primaryColor:l,successColor:r,warningColor:t,errorColor:u,infoColor:n,fontWeightStrong:c}=e;return{fontWeight:c,rotate:"252deg",colorStartPrimary:R(l,{alpha:.6}),colorEndPrimary:l,colorStartInfo:R(n,{alpha:.6}),colorEndInfo:n,colorStartWarning:R(t,{alpha:.6}),colorEndWarning:t,colorStartError:R(u,{alpha:.6}),colorEndError:u,colorStartSuccess:R(r,{alpha:.6}),colorEndSuccess:r}},mn={name:"GradientText",common:G,self:pn};var fn=mn,gn=K("gradient-text",`
 display: inline-block;
 font-weight: var(--n-font-weight);
 -webkit-background-clip: text;
 background-clip: text;
 color: #0000;
 white-space: nowrap;
 background-image: linear-gradient(var(--n-rotate), var(--n-color-start) 0%, var(--n-color-end) 100%);
 transition:
 --n-color-start .3s var(--n-bezier),
 --n-color-end .3s var(--n-bezier);
`);const vn=Object.assign(Object.assign({},U.props),{size:[String,Number],fontSize:[String,Number],type:{type:String,default:"primary"},color:[Object,String],gradient:[Object,String]});var ee=A({name:"GradientText",props:vn,setup(e){en();const{mergedClsPrefixRef:l,inlineThemeDisabled:r}=Y(e),t=E(()=>{const{type:o}=e;return o==="danger"?"error":o}),u=E(()=>{let o=e.size||e.fontSize;return o&&(o=Te(o)),o||void 0}),n=E(()=>{const o=e.color||e.gradient;if(typeof o=="string")return o;if(o){const v=o.deg||0,h=o.from,w=o.to;return`linear-gradient(${v}deg, ${h} 0%, ${w} 100%)`}}),c=U("GradientText","-gradient-text",gn,fn,e,l),f=E(()=>{const{value:o}=t,{common:{cubicBezierEaseInOut:v},self:{rotate:h,[N("colorStart",o)]:w,[N("colorEnd",o)]:k,fontWeight:x}}=c.value;return{"--n-bezier":v,"--n-rotate":h,"--n-color-start":w,"--n-color-end":k,"--n-font-weight":x}}),d=r?Re("gradient-text",E(()=>t.value[0]),f,e):void 0;return{mergedClsPrefix:l,compatibleType:t,styleFontSize:u,styleBgImage:n,cssVars:r?void 0:f,themeClass:d==null?void 0:d.themeClass,onRender:d==null?void 0:d.onRender}},render(){const{mergedClsPrefix:e,onRender:l}=this;return l==null||l(),P("span",{class:[`${e}-gradient-text`,`${e}-gradient-text--${this.compatibleType}-type`,this.themeClass],style:[{fontSize:this.styleFontSize,backgroundImage:this.styleBgImage},this.cssVars]},this.$slots)}});const hn={class:"whisper-wrap"},wn={class:"whisper-line"},yn={class:"whisper-line send-wrap"},bn=A({__name:"whisper",props:{show:{type:Boolean,default:!1},user:null},emits:["success"],setup(e,{emit:l}){const r=e,t=m(""),u=m(!1),n=()=>{l("success")},c=()=>{u.value=!0,ze({user_id:r.user.id,content:t.value}).then(f=>{window.$message.success("\u53D1\u9001\u6210\u529F"),u.value=!1,t.value="",n()}).catch(f=>{u.value=!1})};return(f,d)=>{const o=ee,v=X,h=Q,w=Z,k=W,x=J;return y(),z(x,{show:e.show,"onUpdate:show":n,class:"whisper-card",preset:"card",size:"small",title:"\u79C1\u4FE1","mask-closable":!1,bordered:!1,style:{width:"360px"}},{default:p(()=>[C("div",hn,[i(h,{"show-icon":!1},{default:p(()=>[S(" \u5373\u5C06\u53D1\u9001\u79C1\u4FE1\u7ED9: "),i(v,{style:{"max-width":"100%"}},{default:p(()=>[i(o,{type:"success"},{default:p(()=>[S($(e.user.nickname)+"@"+$(e.user.username),1)]),_:1})]),_:1})]),_:1}),C("div",wn,[i(w,{type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u79C1\u4FE1\u5185\u5BB9\uFF08\u8BF7\u52FF\u53D1\u9001\u4E0D\u548C\u8C10\u5185\u5BB9\uFF0C\u5426\u5219\u5C06\u4F1A\u88AB\u5C01\u53F7\uFF09",autosize:{minRows:5,maxRows:10},value:t.value,"onUpdate:value":d[0]||(d[0]=b=>t.value=b),maxlength:"200","show-count":""},null,8,["value"])]),C("div",yn,[i(k,{strong:"",secondary:"",type:"primary",loading:u.value,onClick:c},{default:p(()=>[S(" \u53D1\u9001 ")]),_:1},8,["loading"])])])]),_:1},8,["show"])}}});var Cn=O(bn,[["__scopeId","data-v-3e021430"]]);const kn={class:"whisper-wrap"},xn={class:"whisper-line"},Bn={class:"whisper-line send-wrap"},Fn=A({__name:"whisper-add-friend",props:{show:{type:Boolean,default:!1},user:null},emits:["success"],setup(e,{emit:l}){const r=e,t=m(""),u=m(!1),n=()=>{l("success")},c=()=>{u.value=!0,Ae({user_id:r.user.id,greetings:t.value}).then(f=>{window.$message.success("\u53D1\u9001\u6210\u529F"),u.value=!1,t.value="",n()}).catch(f=>{u.value=!1})};return(f,d)=>{const o=ee,v=X,h=Q,w=Z,k=W,x=J;return y(),z(x,{show:e.show,"onUpdate:show":n,class:"whisper-card",preset:"card",size:"small",title:"\u7533\u8BF7\u6DFB\u52A0\u670B\u53CB","mask-closable":!1,bordered:!1,style:{width:"360px"}},{default:p(()=>[C("div",kn,[i(h,{"show-icon":!1},{default:p(()=>[S(" \u53D1\u9001\u6DFB\u52A0\u670B\u53CB\u7533\u8BF7\u7ED9: "),i(v,{style:{"max-width":"100%"}},{default:p(()=>[i(o,{type:"success"},{default:p(()=>[S($(e.user.nickname)+"@"+$(e.user.username),1)]),_:1})]),_:1})]),_:1}),C("div",xn,[i(w,{type:"textarea",placeholder:"\u8BF7\u8F93\u5165\u771F\u631A\u7684\u95EE\u5019\u8BED",autosize:{minRows:5,maxRows:10},value:t.value,"onUpdate:value":d[0]||(d[0]=b=>t.value=b),maxlength:"120","show-count":""},null,8,["value"])]),C("div",Bn,[i(k,{strong:"",secondary:"",type:"primary",loading:u.value,onClick:c},{default:p(()=>[S(" \u53D1\u9001 ")]),_:1},8,["loading"])])])]),_:1},8,["show"])}}});var En=O(Fn,[["__scopeId","data-v-bf9bc04e"]]);const Sn={key:0,class:"profile-baseinfo"},Dn={class:"avatar"},$n={class:"base-info"},Tn={class:"username"},Rn={class:"uid"},zn={key:0,class:"user-opts"},An={key:0,class:"pagination-wrap"},In={key:0,class:"skeleton-wrap"},Pn={key:1},Un={key:0,class:"empty-wrap"},On=A({__name:"User",setup(e){Ie();const l=_n(),r=Ne(),t=Le(),u=m(!1),n=Pe({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,status:1}),c=m(!1),f=m(!1),d=m(!1),o=m([]),v=m(t.query.username||""),h=m(+t.query.p||1),w=m(20),k=m(0),x=()=>{u.value=!0,Ve({username:v.value,page:h.value,page_size:w.value}).then(s=>{u.value=!1,o.value=s.list,k.value=Math.ceil(s.pager.total_rows/w.value),window.scrollTo(0,0)}).catch(s=>{u.value=!1})},b=()=>{c.value=!0,je({username:v.value}).then(s=>{c.value=!1,n.id=s.id,n.avatar=s.avatar,n.username=s.username,n.nickname=s.nickname,n.is_admin=s.is_admin,n.is_friend=s.is_friend,n.status=s.status,x()}).catch(s=>{c.value=!1,console.log(s)})},a=s=>{h.value=s,x()},_=()=>{f.value=!0},g=()=>{d.value=!0},B=()=>{f.value=!1},I=()=>{d.value=!1},ne=E(()=>{let s=[{label:"\u79C1\u4FE1",key:"whisper"}];return r.state.userInfo.is_admin&&(n.status===1?s.push({label:"\u7981\u8A00",key:"banned"}):s.push({label:"\u89E3\u5C01",key:"deblocking"})),n.is_friend?s.push({label:"\u5220\u9664\u597D\u53CB",key:"delete"}):s.push({label:"\u6DFB\u52A0\u670B\u53CB",key:"requesting"}),s}),te=s=>{switch(s){case"whisper":_();break;case"delete":se();break;case"requesting":g();break;case"banned":case"deblocking":ae();break}},se=()=>{l.warning({title:"\u5220\u9664\u597D\u53CB",content:"\u5C06\u597D\u53CB \u201C"+n.nickname+"\u201D \u5220\u9664\uFF0C\u5C06\u540C\u65F6\u5220\u9664 \u70B9\u8D5E/\u6536\u85CF \u5217\u8868\u4E2D\u5173\u4E8E\u8BE5\u670B\u53CB\u7684 \u201C\u597D\u53CB\u53EF\u89C1\u201D \u63A8\u6587",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",onPositiveClick:()=>{c.value=!0,He({user_id:n.id}).then(s=>{c.value=!1,n.is_friend=!1,x()}).catch(s=>{c.value=!1,console.log(s)})}})},ae=()=>{l.warning({title:"\u8B66\u544A",content:"\u786E\u5B9A\u5BF9\u8BE5\u7528\u6237\u8FDB\u884C"+(n.status===1?"\u7981\u8A00":"\u89E3\u5C01")+"\u5904\u7406\u5417\uFF1F",positiveText:"\u786E\u5B9A",negativeText:"\u53D6\u6D88",onPositiveClick:()=>{c.value=!0,Ge({id:n.id,status:n.status===1?2:1}).then(s=>{c.value=!1,b()}).catch(s=>{c.value=!1,console.log(s)})}})};return Ue(()=>({path:t.path,query:t.query}),(s,L)=>{L.path==="/user"&&s.path==="/user"&&(v.value=t.query.username||"",b())}),Oe(()=>{b()}),(s,L)=>{const oe=sn,ie=Ke,j=Ye,le=We,ue=W,re=Ze,ce=Cn,de=Je,_e=ln,pe=Qe,me=Xe,fe=be,ge=nn,ve=ye,he=tn,we=on;return y(),F("div",null,[i(oe,{title:"\u7528\u6237\u8BE6\u60C5"}),i(we,{class:"main-content-wrap profile-wrap",bordered:""},{footer:p(()=>[k.value>0?(y(),F("div",An,[i(_e,{page:h.value,"onUpdate:page":a,"page-slot":D(r).state.collapsedRight?5:8,"page-count":k.value},null,8,["page","page-slot","page-count"])])):T("",!0)]),default:p(()=>[i(de,{show:c.value},{default:p(()=>[n.id>0?(y(),F("div",Sn,[C("div",Dn,[i(ie,{size:"large",src:n.avatar},null,8,["src"])]),C("div",$n,[C("div",Tn,[C("strong",null,$(n.nickname),1),C("span",null," @"+$(n.username),1),D(r).state.userInfo.id>0&&D(r).state.userInfo.username!=n.username&&n.is_friend?(y(),z(j,{key:0,class:"top-tag",type:"info",size:"small",round:""},{default:p(()=>[S(" \u597D\u53CB ")]),_:1})):T("",!0),n.is_admin?(y(),z(j,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:p(()=>[S(" \u7BA1\u7406\u5458 ")]),_:1})):T("",!0)]),C("div",Rn,"UID. "+$(n.id),1)]),D(r).state.userInfo.id>0&&D(r).state.userInfo.username!=n.username?(y(),F("div",zn,[i(re,{placement:"bottom-end",trigger:"click",size:"small",options:D(ne),onSelect:te},{default:p(()=>[i(ue,{quaternary:"",circle:""},{icon:p(()=>[i(le,null,{default:p(()=>[i(D(an))]),_:1})]),_:1})]),_:1},8,["options"])])):T("",!0)])):T("",!0),i(ce,{show:f.value,user:n,onSuccess:B},null,8,["show","user"]),i(En,{show:d.value,user:n,onSuccess:I},null,8,["show","user"])]),_:1},8,["show"]),i(me,{class:"profile-tabs-wrap",animated:""},{default:p(()=>[i(pe,{name:"post",tab:"\u6CE1\u6CE1"})]),_:1}),u.value?(y(),F("div",In,[i(fe,{num:w.value},null,8,["num"])])):(y(),F("div",Pn,[o.value.length===0?(y(),F("div",Un,[i(ge,{size:"large",description:"\u6682\u65E0\u6570\u636E"})])):T("",!0),(y(!0),F(qe,null,Me(o.value,q=>(y(),z(he,{key:q.id},{default:p(()=>[i(ve,{post:q},null,8,["post"])]),_:2},1024))),128))]))]),_:1})])}}});var Jn=O(On,[["__scopeId","data-v-7a6aaa02"]]);export{Jn as default};
