import{p as V,a as D,_ as F,b as I,c as R}from"./content-b5ab8047.js";import{d as A,n as x,a2 as E,o as a,c as m,U as n,a6 as U,a0 as o,a as c,F as Z,a3 as G,a1 as y,Z as l,e as p,L as u,P as r,N as i}from"./@vue-d002002f.js";import{u as J}from"./vuex-4d2f7b35.js";import{b as K,u as Q}from"./vue-router-29e6667f.js";import{b}from"./formatTime-000dbebb.js";import{a as W}from"./copy-to-clipboard-1dd3075d.js";import{i as X,j as Y,l as ee,m as te}from"./@vicons-4022100b.js";import{o as se,M as oe,j as ae,e as ne,O as ie,a as le,L as ue}from"./naive-ui-88b48034.js";const re={class:"post-item"},ce={class:"nickname-wrap"},pe={class:"username-wrap"},_e={key:3},me={class:"timestamp-mobile"},de={class:"item-header-extra"},ve={key:0,class:"timestamp"},he=["innerHTML"],ge={class:"opt-item"},ke={class:"opt-item"},Me=A({__name:"post-item",props:{post:{}},setup(C){const z=C;K();const g=Q(),d=J(),$=x(()=>[{label:"复制链接",key:"copyTweetLink"}]),M=s=>{switch(s){case"copyTweetLink":W(`${window.location.origin}/#/post?id=${e.value.id}`),window.$message.success("链接已复制到剪贴板");break}},e=x(()=>{let s=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},z.post);return s.contents.map(t=>{(+t.type==1||+t.type==2)&&s.texts.push(t),+t.type==3&&s.imgs.push(t),+t.type==4&&s.videos.push(t),+t.type==6&&s.links.push(t),+t.type==7&&s.attachments.push(t),+t.type==8&&s.charge_attachments.push(t)}),s}),k=s=>{g.push({name:"post",query:{id:s}})},T=(s,t)=>{if(s.target.dataset.detail){const _=s.target.dataset.detail.split(":");if(_.length===2){d.commit("refresh"),_[0]==="tag"?g.push({name:"home",query:{q:_[1],t:"tag"}}):g.push({name:"user",query:{username:_[1]}});return}}k(t)};return(s,t)=>{const _=se,L=E("router-link"),f=oe,v=ae,S=ne,q=ie,w=D,N=F,O=I,B=R,j=le,H=ue;return a(),m("div",re,[n(H,{"content-indented":""},U({avatar:o(()=>[n(_,{round:"",size:30,src:e.value.user.avatar},null,8,["src"])]),header:o(()=>[c("span",ce,[n(L,{onClick:t[0]||(t[0]=y(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{username:e.value.user.username}}},{default:o(()=>[p(u(e.value.user.nickname),1)]),_:1},8,["to"])]),c("span",pe," @"+u(e.value.user.username),1),e.value.is_top?(a(),r(f,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:o(()=>[p(" 置顶 ")]),_:1})):i("",!0),e.value.visibility==1?(a(),r(f,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:o(()=>[p(" 私密 ")]),_:1})):i("",!0),e.value.visibility==2?(a(),r(f,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:o(()=>[p(" 好友可见 ")]),_:1})):i("",!0),l(d).state.desktopModelShow?i("",!0):(a(),m("div",_e,[c("span",me,u(l(b)(e.value.created_on))+" "+u(e.value.ip_loc),1)]))]),"header-extra":o(()=>[c("div",de,[l(d).state.desktopModelShow?(a(),m("span",ve,u(e.value.ip_loc?e.value.ip_loc+" · ":e.value.ip_loc)+" "+u(l(b)(e.value.created_on)),1)):i("",!0),l(d).state.desktopModelShow?i("",!0):(a(),r(q,{key:1,placement:"bottom-end",trigger:"click",size:"small",options:$.value,onSelect:M},{default:o(()=>[n(S,{quaternary:"",circle:""},{icon:o(()=>[n(v,null,{default:o(()=>[n(l(X))]),_:1})]),_:1})]),_:1},8,["options"]))])]),footer:o(()=>[e.value.attachments.length>0?(a(),r(w,{key:0,attachments:e.value.attachments},null,8,["attachments"])):i("",!0),e.value.charge_attachments.length>0?(a(),r(w,{key:1,attachments:e.value.charge_attachments,price:e.value.attachment_price},null,8,["attachments","price"])):i("",!0),e.value.imgs.length>0?(a(),r(N,{key:2,imgs:e.value.imgs},null,8,["imgs"])):i("",!0),e.value.videos.length>0?(a(),r(O,{key:3,videos:e.value.videos},null,8,["videos"])):i("",!0),e.value.links.length>0?(a(),r(B,{key:4,links:e.value.links},null,8,["links"])):i("",!0)]),action:o(()=>[n(j,{justify:"space-between"},{default:o(()=>[c("div",ge,[n(v,{size:"18",class:"opt-item-icon"},{default:o(()=>[n(l(Y))]),_:1}),p(" "+u(e.value.upvote_count),1)]),c("div",{class:"opt-item",onClick:t[3]||(t[3]=y(h=>k(e.value.id),["stop"]))},[n(v,{size:"18",class:"opt-item-icon"},{default:o(()=>[n(l(ee))]),_:1}),p(" "+u(e.value.comment_count),1)]),c("div",ke,[n(v,{size:"18",class:"opt-item-icon"},{default:o(()=>[n(l(te))]),_:1}),p(" "+u(e.value.collection_count),1)])]),_:1})]),_:2},[e.value.texts.length>0?{name:"description",fn:o(()=>[c("div",{onClick:t[2]||(t[2]=h=>k(e.value.id))},[(a(!0),m(Z,null,G(e.value.texts,h=>(a(),m("span",{key:h.id,class:"post-text",onClick:t[1]||(t[1]=y(P=>T(P,e.value.id),["stop"])),innerHTML:l(V)(h.content).content},null,8,he))),128))])]),key:"0"}:void 0]),1024)])}}});export{Me as _};
