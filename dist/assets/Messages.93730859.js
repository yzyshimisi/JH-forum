import{d as v,W as n,Y as t,Z as l,ai as F,al as q,am as z,a4 as a,a5 as r,a8 as $,a9 as p,aa as w,a6 as E,a7 as i,a3 as h,cb as I,cp as N,cq as R,cr as P,ae as T,cs as H,af as U,ac as O,ab as A,r as x,a2 as W,aj as Y,ct as Z,$ as G}from"./index.083ec6de.js";import{f as J}from"./formatTime.e07969bb.js";import{_ as K}from"./Alert.cde2ee0c.js";import{_ as Q}from"./Thing.2da2b8ce.js";import{b as X,a as ee,_ as ne}from"./Skeleton.ae0af7f1.js";import{_ as se}from"./main-nav.5bb9b19f.js";import{_ as te}from"./List.79cdd3a1.js";import{_ as oe}from"./Pagination.e4391286.js";const ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},re=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M464 128L240 384l-96-96"},null,-1),le=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M144 384l-96-96"},null,-1),ie=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 128L232 284"},null,-1),ue=[re,le,ie];var ce=v({name:"CheckmarkDoneOutline",render:function(c,_){return n(),t("svg",ae,ue)}});const _e={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},de=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M416 128L192 384l-96-96"},null,-1),me=[de];var pe=v({name:"CheckmarkOutline",render:function(c,_){return n(),t("svg",_e,me)}});const ge={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ke=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 368L144 144"},null,-1),he=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M368 144L144 368"},null,-1),ve=[ke,he];var b=v({name:"CloseOutline",render:function(c,_){return n(),t("svg",ge,ve)}});const we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},fe=l("path",{d:"M336 192h40a40 40 0 0 1 40 40v192a40 40 0 0 1-40 40H136a40 40 0 0 1-40-40V232a40 40 0 0 1 40-40h40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),ye=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M336 128l-80-80l-80 80"},null,-1),xe=l("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M256 321V48"},null,-1),$e=[fe,ye,xe];var Ce=v({name:"ShareOutline",render:function(c,_){return n(),t("svg",we,$e)}});const De={class:"sender-wrap"},Me={key:0,class:"nickname"},Fe={class:"username"},Be={key:1,class:"nickname"},je={class:"timestamp"},be={class:"timestamp-txt"},Ee={key:0,class:"brief-content"},Oe={key:1,class:"whisper-content-wrap"},Ae={key:2,class:"requesting-friend-wrap"},Le={key:2,class:"status-info"},Se={key:3,class:"status-info"},Ve=v({__name:"message-item",props:{message:null},setup(e){const c="https://assets.paopao.info/public/avatar/default/admin.png",_=q(),u=s=>{d(s),(s.type===1||s.type===2||s.type===3)&&(s.post&&s.post.id>0?_.push({name:"post",query:{id:s.post_id}}):window.$message.error("\u8BE5\u52A8\u6001\u5DF2\u88AB\u5220\u9664"))},g=s=>{d(s),N({user_id:s.sender_user_id}).then(o=>{s.reply_id=2,window.$message.success("\u5DF2\u540C\u610F\u6DFB\u52A0\u597D\u53CB")}).catch(o=>{console.log(o)})},f=s=>{d(s),R({user_id:s.sender_user_id}).then(o=>{s.reply_id=3,window.$message.success("\u5DF2\u62D2\u7EDD\u6DFB\u52A0\u597D\u53CB")}).catch(o=>{console.log(o)})},d=s=>{s.is_read===0&&P({id:s.id}).then(o=>{s.is_read=1}).catch(o=>{console.log(o)})};return(s,o)=>{const C=T,m=z("router-link"),B=H,k=U,D=K,M=Q;return n(),t("div",{class:I(["message-item",{unread:e.message.is_read===0}]),onClick:o[4]||(o[4]=y=>d(e.message))},[a(M,{"content-indented":""},{avatar:r(()=>[a(C,{round:"",size:30,src:e.message.sender_user.id>0?e.message.sender_user.avatar:c},null,8,["src"])]),header:r(()=>[l("div",De,[e.message.sender_user.id>0?(n(),t("span",Me,[a(m,{onClick:o[0]||(o[0]=$(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{username:e.message.sender_user.username}}},{default:r(()=>[p(w(e.message.sender_user.nickname),1)]),_:1},8,["to"]),l("span",Fe," @"+w(e.message.sender_user.username),1)])):(n(),t("span",Be," \u7CFB\u7EDF "))])]),"header-extra":r(()=>[l("span",je,[e.message.is_read===0?(n(),E(B,{key:0,dot:"",processing:""})):i("",!0),l("span",be,w(h(J)(e.message.created_on)),1)])]),description:r(()=>[a(D,{"show-icon":!1,class:"brief-wrap",type:e.message.is_read>0?"default":"success"},{default:r(()=>[e.message.type!=4?(n(),t("div",Ee,[p(w(e.message.brief)+" ",1),e.message.type===1||e.message.type===2||e.message.type===3?(n(),t("span",{key:0,onClick:o[1]||(o[1]=$(y=>u(e.message),["stop"])),class:"hash-link view-link"},[a(k,null,{default:r(()=>[a(h(Ce))]),_:1}),p(" \u67E5\u770B\u8BE6\u60C5 ")])):i("",!0)])):i("",!0),e.message.type===4?(n(),t("div",Oe,w(e.message.content),1)):i("",!0),e.message.type===5?(n(),t("div",Ae,[p(w(e.message.content)+" ",1),e.message.reply_id===1?(n(),t("span",{key:0,onClick:o[2]||(o[2]=$(y=>g(e.message),["stop"])),class:"hash-link view-link"},[a(k,null,{default:r(()=>[a(h(pe))]),_:1}),p(" \u540C\u610F ")])):i("",!0),e.message.reply_id===1?(n(),t("span",{key:1,onClick:o[3]||(o[3]=$(y=>f(e.message),["stop"])),class:"hash-link view-link"},[a(k,null,{default:r(()=>[a(h(b))]),_:1}),p(" \u62D2\u7EDD ")])):i("",!0),e.message.reply_id===2?(n(),t("span",Le,[a(k,null,{default:r(()=>[a(h(ce))]),_:1}),p(" \u5DF2\u540C\u610F ")])):i("",!0),e.message.reply_id===3?(n(),t("span",Se,[a(k,null,{default:r(()=>[a(h(b))]),_:1}),p(" \u5DF2\u62D2\u7EDD ")])):i("",!0)])):i("",!0)]),_:1},8,["type"])]),_:1})],2)}}});var qe=F(Ve,[["__scopeId","data-v-44920a13"]]);const ze={class:"content"},Ie=v({__name:"message-skeleton",props:{num:{default:1}},setup(e){return(c,_)=>{const u=X;return n(!0),t(A,null,O(new Array(e.num),g=>(n(),t("div",{class:"skeleton-item",key:g},[l("div",ze,[a(u,{text:"",repeat:2}),a(u,{text:"",style:{width:"60%"}})])]))),128)}}});var Ne=F(Ie,[["__scopeId","data-v-d0b0628c"]]);const Re={key:0,class:"skeleton-wrap"},Pe={key:1},Te={key:0,class:"empty-wrap"},He={key:0,class:"pagination-wrap"},Ue=v({__name:"Messages",setup(e){const c=Y(),_=G(),u=x(!1),g=x(+c.query.p||1),f=x(10),d=x(0),s=x([]),o=()=>{u.value=!0,Z({page:g.value,page_size:f.value}).then(m=>{u.value=!1,s.value=m.list,d.value=Math.ceil(m.pager.total_rows/f.value)}).catch(m=>{u.value=!1})},C=m=>{g.value=m,o()};return W(()=>{o()}),(m,B)=>{const k=se,D=Ne,M=ee,y=qe,L=ne,S=oe,V=te;return n(),t("div",null,[a(k,{title:"\u6D88\u606F"}),a(V,{class:"main-content-wrap messages-wrap",bordered:""},{footer:r(()=>[d.value>1?(n(),t("div",He,[a(S,{page:g.value,"onUpdate:page":C,"page-slot":h(_).state.collapsedRight?5:8,"page-count":d.value},null,8,["page","page-slot","page-count"])])):i("",!0)]),default:r(()=>[u.value?(n(),t("div",Re,[a(D,{num:f.value},null,8,["num"])])):(n(),t("div",Pe,[s.value.length===0?(n(),t("div",Te,[a(M,{size:"large",description:"\u6682\u65E0\u6570\u636E"})])):i("",!0),(n(!0),t(A,null,O(s.value,j=>(n(),E(L,{key:j.id},{default:r(()=>[a(y,{message:j},null,8,["message"])]),_:2},1024))),128))]))]),_:1})])}}});var en=F(Ue,[["__scopeId","data-v-532e9e3c"]]);export{en as default};
