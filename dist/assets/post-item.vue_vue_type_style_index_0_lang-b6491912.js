import{p as B,a as N,_ as P,b as D,c as S}from"./content-fb362960.js";import{d as V,n as H,a1 as F,o as r,c as f,L as l,a6 as I,Y as t,$ as n,a as p,F as A,a2 as E,a0 as v,e as u,M as d,K as _,O as m}from"./@vue-ca177dbe.js";import{u as K}from"./vuex-d28e9067.js";import{u as R}from"./vue-router-88cc84d1.js";import{b as Y}from"./formatTime-000dbebb.js";import{a as ot}from"./copy-to-clipboard-1dd3075d.js";import{i as at,j as G,l as J,m as Q}from"./@vicons-6d35273b.js";import{o as U,M as W,j as X,e as it,O as lt,a as Z,L as tt}from"./naive-ui-2035804c.js";const rt={class:"post-item"},ct={class:"nickname-wrap"},pt={class:"username-wrap"},_t={class:"timestamp-mobile"},mt={class:"item-header-extra"},ut=["innerHTML"],dt={class:"opt-item"},ht={class:"opt-item"},Ot=V({__name:"mobile-post-item",props:{post:null},setup(q){const T=q,g=R(),L=K(),e=H(()=>[{label:"复制链接",key:"copyTweetLink"}]),x=async i=>{switch(i){case"copyTweetLink":ot(`${window.location.origin}/#/post?id=${s.value.id}`),window.$message.success("链接已复制到剪贴板");break}},s=H(()=>{let i=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},T.post);return i.contents.map(a=>{(+a.type==1||+a.type==2)&&i.texts.push(a),+a.type==3&&i.imgs.push(a),+a.type==4&&i.videos.push(a),+a.type==6&&i.links.push(a),+a.type==7&&i.attachments.push(a),+a.type==8&&i.charge_attachments.push(a)}),i}),c=i=>{g.push({name:"post",query:{id:i}})},o=(i,a)=>{if(i.target.dataset.detail){const h=i.target.dataset.detail.split(":");if(h.length===2){L.commit("refresh"),h[0]==="tag"?g.push({name:"home",query:{q:h[1],t:"tag"}}):g.push({name:"user",query:{username:h[1]}});return}}c(a)};return(i,a)=>{const h=U,b=F("router-link"),w=W,y=X,M=it,$=lt,z=N,O=P,k=D,j=S,et=Z,st=tt;return r(),f("div",rt,[l(st,{"content-indented":""},I({avatar:n(()=>[l(h,{round:"",size:30,src:t(s).user.avatar},null,8,["src"])]),header:n(()=>[p("span",ct,[l(b,{onClick:a[0]||(a[0]=v(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{username:t(s).user.username}}},{default:n(()=>[u(d(t(s).user.nickname),1)]),_:1},8,["to"])]),p("span",pt," @"+d(t(s).user.username),1),t(s).is_top?(r(),_(w,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:n(()=>[u(" 置顶 ")]),_:1})):m("",!0),t(s).visibility==1?(r(),_(w,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:n(()=>[u(" 私密 ")]),_:1})):m("",!0),t(s).visibility==2?(r(),_(w,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:n(()=>[u(" 好友可见 ")]),_:1})):m("",!0),p("div",null,[p("span",_t,d(t(Y)(t(s).created_on))+" "+d(t(s).ip_loc),1)])]),"header-extra":n(()=>[p("div",mt,[l($,{placement:"bottom-end",trigger:"click",size:"small",options:t(e),onSelect:x},{default:n(()=>[l(M,{quaternary:"",circle:""},{icon:n(()=>[l(y,null,{default:n(()=>[l(t(at))]),_:1})]),_:1})]),_:1},8,["options"])])]),footer:n(()=>[t(s).attachments.length>0?(r(),_(z,{key:0,attachments:t(s).attachments},null,8,["attachments"])):m("",!0),t(s).charge_attachments.length>0?(r(),_(z,{key:1,attachments:t(s).charge_attachments,price:t(s).attachment_price},null,8,["attachments","price"])):m("",!0),t(s).imgs.length>0?(r(),_(O,{key:2,imgs:t(s).imgs},null,8,["imgs"])):m("",!0),t(s).videos.length>0?(r(),_(k,{key:3,videos:t(s).videos},null,8,["videos"])):m("",!0),t(s).links.length>0?(r(),_(j,{key:4,links:t(s).links},null,8,["links"])):m("",!0)]),action:n(()=>[l(et,{justify:"space-between"},{default:n(()=>[p("div",dt,[l(y,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(G))]),_:1}),u(" "+d(t(s).upvote_count),1)]),p("div",{class:"opt-item",onClick:a[3]||(a[3]=v(C=>c(t(s).id),["stop"]))},[l(y,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(J))]),_:1}),u(" "+d(t(s).comment_count),1)]),p("div",ht,[l(y,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(Q))]),_:1}),u(" "+d(t(s).collection_count),1)])]),_:1})]),_:2},[t(s).texts.length>0?{name:"description",fn:n(()=>[p("div",{onClick:a[2]||(a[2]=C=>c(t(s).id))},[(r(!0),f(A,null,E(t(s).texts,C=>(r(),f("span",{key:C.id,class:"post-text",onClick:a[1]||(a[1]=v(nt=>o(nt,t(s).id),["stop"])),innerHTML:t(B)(C.content).content},null,8,ut))),128))])]),key:"0"}:void 0]),1024)])}}});const gt={class:"nickname-wrap"},yt={class:"username-wrap"},kt={class:"item-header-extra"},ft={class:"timestamp"},vt=["innerHTML"],xt={class:"opt-item"},wt={class:"opt-item"},jt=V({__name:"post-item",props:{post:null},setup(q){const T=q,g=R(),L=K(),e=H(()=>{let c=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},T.post);return c.contents.map(o=>{(+o.type==1||+o.type==2)&&c.texts.push(o),+o.type==3&&c.imgs.push(o),+o.type==4&&c.videos.push(o),+o.type==6&&c.links.push(o),+o.type==7&&c.attachments.push(o),+o.type==8&&c.charge_attachments.push(o)}),c}),x=c=>{g.push({name:"post",query:{id:c}})},s=(c,o)=>{if(c.target.dataset.detail){const i=c.target.dataset.detail.split(":");if(i.length===2){L.commit("refresh"),i[0]==="tag"?g.push({name:"home",query:{q:i[1],t:"tag"}}):g.push({name:"user",query:{username:i[1]}});return}}x(o)};return(c,o)=>{const i=U,a=F("router-link"),h=W,b=N,w=P,y=D,M=S,$=X,z=Z,O=tt;return r(),f("div",{class:"post-item",onClick:o[3]||(o[3]=k=>x(t(e).id))},[l(O,{"content-indented":""},I({avatar:n(()=>[l(i,{round:"",size:30,src:t(e).user.avatar},null,8,["src"])]),header:n(()=>[p("span",gt,[l(a,{onClick:o[0]||(o[0]=v(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{username:t(e).user.username}}},{default:n(()=>[u(d(t(e).user.nickname),1)]),_:1},8,["to"])]),p("span",yt," @"+d(t(e).user.username),1),t(e).is_top?(r(),_(h,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:n(()=>[u(" 置顶 ")]),_:1})):m("",!0),t(e).visibility==1?(r(),_(h,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:n(()=>[u(" 私密 ")]),_:1})):m("",!0),t(e).visibility==2?(r(),_(h,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:n(()=>[u(" 好友可见 ")]),_:1})):m("",!0)]),"header-extra":n(()=>[p("div",kt,[p("span",ft,d(t(e).ip_loc?t(e).ip_loc+" · ":t(e).ip_loc)+" "+d(t(Y)(t(e).created_on)),1)])]),footer:n(()=>[t(e).attachments.length>0?(r(),_(b,{key:0,attachments:t(e).attachments},null,8,["attachments"])):m("",!0),t(e).charge_attachments.length>0?(r(),_(b,{key:1,attachments:t(e).charge_attachments,price:t(e).attachment_price},null,8,["attachments","price"])):m("",!0),t(e).imgs.length>0?(r(),_(w,{key:2,imgs:t(e).imgs},null,8,["imgs"])):m("",!0),t(e).videos.length>0?(r(),_(y,{key:3,videos:t(e).videos},null,8,["videos"])):m("",!0),t(e).links.length>0?(r(),_(M,{key:4,links:t(e).links},null,8,["links"])):m("",!0)]),action:n(()=>[l(z,{justify:"space-between"},{default:n(()=>[p("div",xt,[l($,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(G))]),_:1}),u(" "+d(t(e).upvote_count),1)]),p("div",{class:"opt-item",onClick:o[2]||(o[2]=v(k=>x(t(e).id),["stop"]))},[l($,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(J))]),_:1}),u(" "+d(t(e).comment_count),1)]),p("div",wt,[l($,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(Q))]),_:1}),u(" "+d(t(e).collection_count),1)])]),_:1})]),_:2},[t(e).texts.length>0?{name:"description",fn:n(()=>[(r(!0),f(A,null,E(t(e).texts,k=>(r(),f("span",{key:k.id,class:"post-text",onClick:o[1]||(o[1]=v(j=>s(j,t(e).id),["stop"])),innerHTML:t(B)(k.content).content},null,8,vt))),128))]),key:"0"}:void 0]),1024)])}}});export{jt as _,Ot as a};
