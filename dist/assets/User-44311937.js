import{_ as ce}from"./post-item.vue_vue_type_style_index_0_lang-0b64a8ce.js";import{_ as re}from"./post-skeleton-8710588f.js";import{B as ue,_ as I,C as pe,D as de,A as me,E as he,F as ve}from"./index-0f3021a1.js";import{Q as B,R as M,S as R,b as T,e as S,i as A,u as fe,T as ge,F as we,G as ye,o as ke,M as be,j as xe,O as $e,k as Ue,f as Fe,g as ze,I as Ie,H as Se}from"./naive-ui-88b48034.js";import{d as q,r as c,o as _,P as F,a0 as t,a as r,U as n,e as m,L as b,D as qe,n as We,w as Ce,j as Pe,c as d,Z as $,N as U,F as Be,a3 as Me}from"./@vue-d002002f.js";import{_ as Re}from"./main-nav.vue_vue_type_style_index_0_lang-6d03f8cc.js";import{u as Te}from"./vuex-4d2f7b35.js";import{b as Ae}from"./vue-router-29e6667f.js";import{i as De}from"./@vicons-4022100b.js";import"./content-b5ab8047.js";import"./paopao-video-player-d47e9bf6.js";import"./formatTime-000dbebb.js";import"./moment-b7869f98.js";import"./copy-to-clipboard-1dd3075d.js";import"./toggle-selection-93f4ad84.js";import"./axios-4a70c6fc.js";/* empty css               */import"./seemly-76b7b838.js";import"./vueuc-0232e3b9.js";import"./evtd-b614532e.js";import"./@css-render-6b6cdab1.js";import"./vooks-77bdadbd.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-6a5c5852.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-8412e618.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";const Ne={class:"whisper-wrap"},Ve={class:"whisper-line"},Le={class:"whisper-line send-wrap"},je=q({__name:"whisper",props:{show:{type:Boolean,default:!1},user:{}},emits:["success"],setup(z,{emit:x}){const u=z,o=c(""),l=c(!1),e=()=>{x("success")},i=()=>{l.value=!0,ue({user_id:u.user.id,content:o.value}).then(a=>{window.$message.success("发送成功"),l.value=!1,o.value="",e()}).catch(a=>{l.value=!1})};return(a,p)=>{const h=B,v=M,f=R,g=T,w=S,y=A;return _(),F(y,{show:a.show,"onUpdate:show":e,class:"whisper-card",preset:"card",size:"small",title:"私信","mask-closable":!1,bordered:!1,style:{width:"360px"}},{default:t(()=>[r("div",Ne,[n(f,{"show-icon":!1},{default:t(()=>[m(" 即将发送私信给: "),n(v,{style:{"max-width":"100%"}},{default:t(()=>[n(h,{type:"success"},{default:t(()=>[m(b(a.user.nickname)+"@"+b(a.user.username),1)]),_:1})]),_:1})]),_:1}),r("div",Ve,[n(g,{type:"textarea",placeholder:"请输入私信内容（请勿发送不和谐内容，否则将会被封号）",autosize:{minRows:5,maxRows:10},value:o.value,"onUpdate:value":p[0]||(p[0]=k=>o.value=k),maxlength:"200","show-count":""},null,8,["value"])]),r("div",Le,[n(w,{strong:"",secondary:"",type:"primary",loading:l.value,onClick:i},{default:t(()=>[m(" 发送 ")]),_:1},8,["loading"])])])]),_:1},8,["show"])}}});const Ee=I(je,[["__scopeId","data-v-0cbfe47c"]]),He={class:"whisper-wrap"},Oe={class:"whisper-line"},Ge={class:"whisper-line send-wrap"},Qe=q({__name:"whisper-add-friend",props:{show:{type:Boolean,default:!1},user:{}},emits:["success"],setup(z,{emit:x}){const u=z,o=c(""),l=c(!1),e=()=>{x("success")},i=()=>{l.value=!0,pe({user_id:u.user.id,greetings:o.value}).then(a=>{window.$message.success("发送成功"),l.value=!1,o.value="",e()}).catch(a=>{l.value=!1})};return(a,p)=>{const h=B,v=M,f=R,g=T,w=S,y=A;return _(),F(y,{show:a.show,"onUpdate:show":e,class:"whisper-card",preset:"card",size:"small",title:"申请添加朋友","mask-closable":!1,bordered:!1,style:{width:"360px"}},{default:t(()=>[r("div",He,[n(f,{"show-icon":!1},{default:t(()=>[m(" 发送添加朋友申请给: "),n(v,{style:{"max-width":"100%"}},{default:t(()=>[n(h,{type:"success"},{default:t(()=>[m(b(a.user.nickname)+"@"+b(a.user.username),1)]),_:1})]),_:1})]),_:1}),r("div",Oe,[n(g,{type:"textarea",placeholder:"请输入真挚的问候语",autosize:{minRows:5,maxRows:10},value:o.value,"onUpdate:value":p[0]||(p[0]=k=>o.value=k),maxlength:"120","show-count":""},null,8,["value"])]),r("div",Ge,[n(w,{strong:"",secondary:"",type:"primary",loading:l.value,onClick:i},{default:t(()=>[m(" 发送 ")]),_:1},8,["loading"])])])]),_:1},8,["show"])}}});const Ze=I(Qe,[["__scopeId","data-v-60be56a2"]]),Je={key:0,class:"profile-baseinfo"},Ke={class:"avatar"},Xe={class:"base-info"},Ye={class:"username"},es={class:"uid"},ss={key:0,class:"user-opts"},ns={key:0,class:"skeleton-wrap"},ts={key:1},os={key:0,class:"empty-wrap"},as={key:0,class:"pagination-wrap"},ls=q({__name:"User",setup(z){fe();const x=ge(),u=Te(),o=Ae(),l=c(!1),e=qe({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,status:1}),i=c(!1),a=c(!1),p=c(!1),h=c([]),v=c(o.query.username||""),f=c(+o.query.p||1),g=c(20),w=c(0),y=()=>{l.value=!0,me({username:v.value,page:f.value,page_size:g.value}).then(s=>{l.value=!1,h.value=s.list,w.value=Math.ceil(s.pager.total_rows/g.value),window.scrollTo(0,0)}).catch(s=>{l.value=!1})},k=()=>{i.value=!0,de({username:v.value}).then(s=>{i.value=!1,e.id=s.id,e.avatar=s.avatar,e.username=s.username,e.nickname=s.nickname,e.is_admin=s.is_admin,e.is_friend=s.is_friend,e.status=s.status,y()}).catch(s=>{i.value=!1,console.log(s)})},D=s=>{f.value=s,y()},N=()=>{a.value=!0},V=()=>{p.value=!0},L=()=>{a.value=!1},j=()=>{p.value=!1},E=We(()=>{let s=[{label:"私信",key:"whisper"}];return u.state.userInfo.is_admin&&(e.status===1?s.push({label:"禁言",key:"banned"}):s.push({label:"解封",key:"deblocking"})),e.is_friend?s.push({label:"删除好友",key:"delete"}):s.push({label:"添加朋友",key:"requesting"}),s}),H=s=>{switch(s){case"whisper":N();break;case"delete":O();break;case"requesting":V();break;case"banned":case"deblocking":G();break}},O=()=>{x.warning({title:"删除好友",content:"将好友 “"+e.nickname+"” 删除，将同时删除 点赞/收藏 列表中关于该朋友的 “好友可见” 推文",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{i.value=!0,he({user_id:e.id}).then(s=>{i.value=!1,e.is_friend=!1,y()}).catch(s=>{i.value=!1,console.log(s)})}})},G=()=>{x.warning({title:"警告",content:"确定对该用户进行"+(e.status===1?"禁言":"解封")+"处理吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{i.value=!0,ve({id:e.id,status:e.status===1?2:1}).then(s=>{i.value=!1,k()}).catch(s=>{i.value=!1,console.log(s)})}})};return Ce(()=>({path:o.path,query:o.query}),(s,W)=>{W.path==="/user"&&s.path==="/user"&&(v.value=o.query.username||"",k())}),Pe(()=>{k()}),(s,W)=>{const Q=Re,Z=ke,C=be,J=xe,K=S,X=$e,Y=Ee,ee=Ue,se=Fe,ne=ze,te=re,oe=Ie,ae=ce,le=Se,ie=we,_e=ye;return _(),d("div",null,[n(Q,{title:"用户详情"}),n(ie,{class:"main-content-wrap profile-wrap",bordered:""},{default:t(()=>[n(ee,{show:i.value},{default:t(()=>[e.id>0?(_(),d("div",Je,[r("div",Ke,[n(Z,{size:"large",src:e.avatar},null,8,["src"])]),r("div",Xe,[r("div",Ye,[r("strong",null,b(e.nickname),1),r("span",null," @"+b(e.username),1),$(u).state.userInfo.id>0&&$(u).state.userInfo.username!=e.username&&e.is_friend?(_(),F(C,{key:0,class:"top-tag",type:"info",size:"small",round:""},{default:t(()=>[m(" 好友 ")]),_:1})):U("",!0),e.is_admin?(_(),F(C,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:t(()=>[m(" 管理员 ")]),_:1})):U("",!0)]),r("div",es,"UID. "+b(e.id),1)]),$(u).state.userInfo.id>0&&$(u).state.userInfo.username!=e.username?(_(),d("div",ss,[n(X,{placement:"bottom-end",trigger:"click",size:"small",options:E.value,onSelect:H},{default:t(()=>[n(K,{quaternary:"",circle:""},{icon:t(()=>[n(J,null,{default:t(()=>[n($(De))]),_:1})]),_:1})]),_:1},8,["options"])])):U("",!0)])):U("",!0),n(Y,{show:a.value,user:e,onSuccess:L},null,8,["show","user"]),n(Ze,{show:p.value,user:e,onSuccess:j},null,8,["show","user"])]),_:1},8,["show"]),n(ne,{class:"profile-tabs-wrap",animated:""},{default:t(()=>[n(se,{name:"post",tab:"泡泡"})]),_:1}),l.value?(_(),d("div",ns,[n(te,{num:g.value},null,8,["num"])])):(_(),d("div",ts,[h.value.length===0?(_(),d("div",os,[n(oe,{size:"large",description:"暂无数据"})])):U("",!0),(_(!0),d(Be,null,Me(h.value,P=>(_(),F(le,{key:P.id},{default:t(()=>[n(ae,{post:P},null,8,["post"])]),_:2},1024))),128))]))]),_:1}),w.value>0?(_(),d("div",as,[n(_e,{page:f.value,"onUpdate:page":D,"page-slot":$(u).state.collapsedRight?5:8,"page-count":w.value},null,8,["page","page-slot","page-count"])])):U("",!0)])}}});const Ts=I(ls,[["__scopeId","data-v-46a0183a"]]);export{Ts as default};
