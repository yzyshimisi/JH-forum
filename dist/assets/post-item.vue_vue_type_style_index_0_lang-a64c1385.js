import{p as N,a as P,_ as D,b as S,c as V}from"./content-d59ed5a8.js";import{d as F,r as T,n as E,j as I,a1 as A,o as r,c as v,L as l,a6 as K,Y as t,$ as n,a as p,F as R,a2 as Y,a0 as x,e as m,M as d,K as u,O as _}from"./@vue-ca177dbe.js";import{u as G}from"./vuex-d28e9067.js";import{u as J}from"./vue-router-88cc84d1.js";import{b as Q}from"./formatTime-000dbebb.js";import{a as rt}from"./copy-to-clipboard-1dd3075d.js";import{i as ct,j as U,l as X,m as Z}from"./@vicons-6d35273b.js";import{o as tt,M as et,j as st,e as pt,O as ut,a as nt,L as ot}from"./naive-ui-2035804c.js";const _t={class:"nickname-wrap"},mt={class:"username-wrap"},dt={class:"timestamp-mobile"},ht={class:"item-header-extra"},gt=["innerHTML"],ft={class:"opt-item"},kt={class:"opt-item"},Ht=F({__name:"mobile-post-item",props:{post:null},setup(L){const O=L,f=J(),W=G(),w=T(null),h=T(0),e=E(()=>[{label:"复制链接",key:"copyTweetLink"}]),$=async o=>{switch(o){case"copyTweetLink":rt(`${window.location.origin}/#/post?id=${s.value.id}`),window.$message.success("链接已复制到剪贴板");break}},s=E(()=>{let o=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},O.post);return o.contents.map(i=>{(+i.type==1||+i.type==2)&&o.texts.push(i),+i.type==3&&o.imgs.push(i),+i.type==4&&o.videos.push(i),+i.type==6&&o.links.push(i),+i.type==7&&o.attachments.push(i),+i.type==8&&o.charge_attachments.push(i)}),o}),c=o=>{f.push({name:"post",query:{id:o}})},a=(o,i)=>{if(o.target.dataset.detail){const g=o.target.dataset.detail.split(":");if(g.length===2){W.commit("refresh"),g[0]==="tag"?f.push({name:"home",query:{q:g[1],t:"tag"}}):f.push({name:"user",query:{username:g[1]}});return}}c(i)};return I(()=>{var o;h.value=((o=w.value)==null?void 0:o.clientWidth)||0,h.value>0?h.value*=.72:h.value=242}),(o,i)=>{const g=tt,C=A("router-link"),b=et,k=st,j=pt,z=ut,q=P,H=D,y=S,B=V,at=nt,it=ot;return r(),v("div",{class:"post-item",ref_key:"parrentElem",ref:w},[l(it,{"content-indented":""},K({avatar:n(()=>[l(g,{round:"",size:30,src:t(s).user.avatar},null,8,["src"])]),header:n(()=>[p("span",_t,[l(C,{onClick:i[0]||(i[0]=x(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{username:t(s).user.username}}},{default:n(()=>[m(d(t(s).user.nickname),1)]),_:1},8,["to"])]),p("span",mt," @"+d(t(s).user.username),1),t(s).is_top?(r(),u(b,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:n(()=>[m(" 置顶 ")]),_:1})):_("",!0),t(s).visibility==1?(r(),u(b,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:n(()=>[m(" 私密 ")]),_:1})):_("",!0),t(s).visibility==2?(r(),u(b,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:n(()=>[m(" 好友可见 ")]),_:1})):_("",!0),p("div",null,[p("span",dt,d(t(Q)(t(s).created_on))+" "+d(t(s).ip_loc),1)])]),"header-extra":n(()=>[p("div",ht,[l(z,{placement:"bottom-end",trigger:"click",size:"small",options:t(e),onSelect:$},{default:n(()=>[l(j,{quaternary:"",circle:""},{icon:n(()=>[l(k,null,{default:n(()=>[l(t(ct))]),_:1})]),_:1})]),_:1},8,["options"])])]),footer:n(()=>[t(s).attachments.length>0?(r(),u(q,{key:0,attachments:t(s).attachments},null,8,["attachments"])):_("",!0),t(s).charge_attachments.length>0?(r(),u(q,{key:1,attachments:t(s).charge_attachments,price:t(s).attachment_price},null,8,["attachments","price"])):_("",!0),t(s).imgs.length>0?(r(),u(H,{key:2,imgs:t(s).imgs},null,8,["imgs"])):_("",!0),t(s).videos.length>0?(r(),u(y,{key:3,videos:t(s).videos},null,8,["videos"])):_("",!0),t(s).links.length>0?(r(),u(B,{key:4,links:t(s).links,maxWidth:h.value},null,8,["links","maxWidth"])):_("",!0)]),action:n(()=>[l(at,{justify:"space-between"},{default:n(()=>[p("div",ft,[l(k,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(U))]),_:1}),m(" "+d(t(s).upvote_count),1)]),p("div",{class:"opt-item",onClick:i[3]||(i[3]=x(M=>c(t(s).id),["stop"]))},[l(k,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(X))]),_:1}),m(" "+d(t(s).comment_count),1)]),p("div",kt,[l(k,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(Z))]),_:1}),m(" "+d(t(s).collection_count),1)])]),_:1})]),_:2},[t(s).texts.length>0?{name:"description",fn:n(()=>[p("div",{onClick:i[2]||(i[2]=M=>c(t(s).id))},[(r(!0),v(R,null,Y(t(s).texts,M=>(r(),v("span",{key:M.id,class:"post-text",onClick:i[1]||(i[1]=x(lt=>a(lt,t(s).id),["stop"])),innerHTML:t(N)(M.content).content},null,8,gt))),128))])]),key:"0"}:void 0]),1024)],512)}}});const yt={class:"nickname-wrap"},vt={class:"username-wrap"},xt={class:"item-header-extra"},wt={class:"timestamp"},$t=["innerHTML"],bt={class:"opt-item"},zt={class:"opt-item"},Bt=F({__name:"post-item",props:{post:null},setup(L){const O=L,f=J(),W=G(),w=T(null),h=T(0),e=E(()=>{let c=Object.assign({texts:[],imgs:[],videos:[],links:[],attachments:[],charge_attachments:[]},O.post);return c.contents.map(a=>{(+a.type==1||+a.type==2)&&c.texts.push(a),+a.type==3&&c.imgs.push(a),+a.type==4&&c.videos.push(a),+a.type==6&&c.links.push(a),+a.type==7&&c.attachments.push(a),+a.type==8&&c.charge_attachments.push(a)}),c}),$=c=>{f.push({name:"post",query:{id:c}})},s=(c,a)=>{if(c.target.dataset.detail){const o=c.target.dataset.detail.split(":");if(o.length===2){W.commit("refresh"),o[0]==="tag"?f.push({name:"home",query:{q:o[1],t:"tag"}}):f.push({name:"user",query:{username:o[1]}});return}}$(a)};return I(()=>{var c;h.value=((c=w.value)==null?void 0:c.clientWidth)||0,h.value>0?h.value*=.78:h.value=422}),(c,a)=>{const o=tt,i=A("router-link"),g=et,C=P,b=D,k=S,j=V,z=st,q=nt,H=ot;return r(),v("div",{class:"post-item",onClick:a[3]||(a[3]=y=>$(t(e).id)),ref_key:"parrentElem",ref:w},[l(H,{"content-indented":""},K({avatar:n(()=>[l(o,{round:"",size:30,src:t(e).user.avatar},null,8,["src"])]),header:n(()=>[p("span",yt,[l(i,{onClick:a[0]||(a[0]=x(()=>{},["stop"])),class:"username-link",to:{name:"user",query:{username:t(e).user.username}}},{default:n(()=>[m(d(t(e).user.nickname),1)]),_:1},8,["to"])]),p("span",vt," @"+d(t(e).user.username),1),t(e).is_top?(r(),u(g,{key:0,class:"top-tag",type:"warning",size:"small",round:""},{default:n(()=>[m(" 置顶 ")]),_:1})):_("",!0),t(e).visibility==1?(r(),u(g,{key:1,class:"top-tag",type:"error",size:"small",round:""},{default:n(()=>[m(" 私密 ")]),_:1})):_("",!0),t(e).visibility==2?(r(),u(g,{key:2,class:"top-tag",type:"info",size:"small",round:""},{default:n(()=>[m(" 好友可见 ")]),_:1})):_("",!0)]),"header-extra":n(()=>[p("div",xt,[p("span",wt,d(t(e).ip_loc?t(e).ip_loc+" · ":t(e).ip_loc)+" "+d(t(Q)(t(e).created_on)),1)])]),footer:n(()=>[t(e).attachments.length>0?(r(),u(C,{key:0,attachments:t(e).attachments},null,8,["attachments"])):_("",!0),t(e).charge_attachments.length>0?(r(),u(C,{key:1,attachments:t(e).charge_attachments,price:t(e).attachment_price},null,8,["attachments","price"])):_("",!0),t(e).imgs.length>0?(r(),u(b,{key:2,imgs:t(e).imgs},null,8,["imgs"])):_("",!0),t(e).videos.length>0?(r(),u(k,{key:3,videos:t(e).videos},null,8,["videos"])):_("",!0),t(e).links.length>0?(r(),u(j,{key:4,links:t(e).links,maxWidth:h.value},null,8,["links","maxWidth"])):_("",!0)]),action:n(()=>[l(q,{justify:"space-between"},{default:n(()=>[p("div",bt,[l(z,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(U))]),_:1}),m(" "+d(t(e).upvote_count),1)]),p("div",{class:"opt-item",onClick:a[2]||(a[2]=x(y=>$(t(e).id),["stop"]))},[l(z,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(X))]),_:1}),m(" "+d(t(e).comment_count),1)]),p("div",zt,[l(z,{size:"18",class:"opt-item-icon"},{default:n(()=>[l(t(Z))]),_:1}),m(" "+d(t(e).collection_count),1)])]),_:1})]),_:2},[t(e).texts.length>0?{name:"description",fn:n(()=>[(r(!0),v(R,null,Y(t(e).texts,y=>(r(),v("span",{key:y.id,class:"post-text",onClick:a[1]||(a[1]=x(B=>s(B,t(e).id),["stop"])),innerHTML:t(N)(y.content).content},null,8,$t))),128))]),key:"0"}:void 0]),1024)],512)}}});export{Bt as _,Ht as a};
