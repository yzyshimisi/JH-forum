import{_ as Ve,a as He}from"./post-item.vue_vue_type_style_index_0_lang-630b4bde.js";import{_ as je}from"./post-skeleton-335ef28d.js";import{C as Ee,_ as j,D as Ge,E as Je,B as O,F as Qe,G as Ke,H as Xe,I as Ye}from"./index-7e85397f.js";import{R as ve,J as de,S as me,b as fe,e as E,i as he,T as Ze,F as es,a as ss,j as ue,o as as,M as ts,O as os,k as ns,f as ls,g as us,H as is,G as cs}from"./naive-ui-e703c4e6.js";import{d as G,r as n,o as c,Q as y,a1 as i,a as r,V as t,e as g,M as h,E as rs,n as _s,j as ps,w as vs,a3 as ds,c as w,O as P,_ as f,a2 as ie,F as ce,a4 as re,s as _e}from"./@vue-e0e89260.js";import{_ as ms}from"./main-nav.vue_vue_type_style_index_0_lang-5e739bf2.js";import{u as fs}from"./vuex-473b3783.js";import{b as hs}from"./vue-router-b8e3382f.js";import{b as gs}from"./formatTime-4210fcd1.js";import{W as ws}from"./v3-infinite-loading-e5c2e8bf.js";import{i as ks,w as ys,x as pe,y as bs,z as Ps,D as $s,G as xs}from"./@vicons-0524c43e.js";import"./content-72c6f607.js";import"./paopao-video-player-aa5e8b3f.js";import"./copy-to-clipboard-1dd3075d.js";import"./toggle-selection-93f4ad84.js";import"./axios-4a70c6fc.js";/* empty css               */import"./seemly-76b7b838.js";import"./vueuc-59ca65c3.js";import"./evtd-b614532e.js";import"./@css-render-580d83ec.js";import"./vooks-a50491fd.js";import"./vdirs-b0483831.js";import"./@juggle-41516555.js";import"./css-render-6a5c5852.js";import"./@emotion-8a8e73f6.js";import"./lodash-es-8412e618.js";import"./treemate-25c27bff.js";import"./async-validator-dee29e8b.js";import"./date-fns-975a2d8f.js";import"./moment-2ab8298d.js";const Ts={class:"whisper-wrap"},zs={class:"whisper-line"},Us={class:"whisper-line send-wrap"},Is=G({__name:"whisper",props:{show:{type:Boolean,default:!1},user:{}},emits:["success"],setup(B,{emit:$}){const d=B,p=n(""),u=n(!1),v=()=>{$("success")},s=()=>{u.value=!0,Ee({user_id:d.user.id,content:p.value}).then(l=>{window.$message.success("发送成功"),u.value=!1,p.value="",v()}).catch(l=>{u.value=!1})};return(l,k)=>{const x=ve,a=de,U=me,I=fe,M=E,C=he;return c(),y(C,{show:l.show,"onUpdate:show":v,class:"whisper-card",preset:"card",size:"small",title:"私信","mask-closable":!1,bordered:!1,style:{width:"360px"}},{default:i(()=>[r("div",Ts,[t(U,{"show-icon":!1},{default:i(()=>[g(" 即将发送私信给: "),t(a,{style:{"max-width":"100%"}},{default:i(()=>[t(x,{type:"success"},{default:i(()=>[g(h(l.user.nickname)+"@"+h(l.user.username),1)]),_:1})]),_:1})]),_:1}),r("div",zs,[t(I,{type:"textarea",placeholder:"请输入私信内容（请勿发送不和谐内容，否则将会被封号）",autosize:{minRows:5,maxRows:10},value:p.value,"onUpdate:value":k[0]||(k[0]=F=>p.value=F),maxlength:"200","show-count":""},null,8,["value"])]),r("div",Us,[t(M,{strong:"",secondary:"",type:"primary",loading:u.value,onClick:s},{default:i(()=>[g(" 发送 ")]),_:1},8,["loading"])])])]),_:1},8,["show"])}}});const Ms=j(Is,[["__scopeId","data-v-0cbfe47c"]]),Cs={class:"whisper-wrap"},Fs={class:"whisper-line"},qs={class:"whisper-line send-wrap"},Ss=G({__name:"whisper-add-friend",props:{show:{type:Boolean,default:!1},user:{}},emits:["success"],setup(B,{emit:$}){const d=B,p=n(""),u=n(!1),v=()=>{$("success")},s=()=>{u.value=!0,Ge({user_id:d.user.id,greetings:p.value}).then(l=>{window.$message.success("发送成功"),u.value=!1,p.value="",v()}).catch(l=>{u.value=!1})};return(l,k)=>{const x=ve,a=de,U=me,I=fe,M=E,C=he;return c(),y(C,{show:l.show,"onUpdate:show":v,class:"whisper-card",preset:"card",size:"small",title:"申请添加朋友","mask-closable":!1,bordered:!1,style:{width:"360px"}},{default:i(()=>[r("div",Cs,[t(U,{"show-icon":!1},{default:i(()=>[g(" 发送添加朋友申请给: "),t(a,{style:{"max-width":"100%"}},{default:i(()=>[t(x,{type:"success"},{default:i(()=>[g(h(l.user.nickname)+"@"+h(l.user.username),1)]),_:1})]),_:1})]),_:1}),r("div",Fs,[t(I,{type:"textarea",placeholder:"请输入真挚的问候语",autosize:{minRows:5,maxRows:10},value:p.value,"onUpdate:value":k[0]||(k[0]=F=>p.value=F),maxlength:"120","show-count":""},null,8,["value"])]),r("div",qs,[t(M,{strong:"",secondary:"",type:"primary",loading:u.value,onClick:s},{default:i(()=>[g(" 发送 ")]),_:1},8,["loading"])])])]),_:1},8,["show"])}}});const Ws=j(Ss,[["__scopeId","data-v-60be56a2"]]),Os={key:0,class:"profile-baseinfo"},Bs={class:"avatar"},Ds={class:"base-info"},Ls={class:"username"},Rs={class:"userinfo"},As={class:"info-item"},Ns={class:"info-item"},Vs={class:"userinfo"},Hs={class:"info-item"},js={class:"info-item"},Es={key:0,class:"user-opts"},Gs={key:0,class:"skeleton-wrap"},Js={key:1},Qs={key:0,class:"empty-wrap"},Ks={key:1},Xs={key:2},Ys={class:"load-more-wrap"},Zs={class:"load-more-spinner"},ea=G({__name:"User",setup(B){const $=Ze(),d=fs(),p=hs(),u=n(!1),v=n(!1),s=rs({id:0,avatar:"",username:"",nickname:"",is_admin:!1,is_friend:!0,is_following:!1,created_on:0,follows:0,followings:0,status:1}),l=n(!1),k=n(!1),x=n(!1),a=n([]),U=n([]),I=n([]),M=n([]),C=n([]),F=n([]),T=n(p.query.s||""),o=n(+p.query.p||1),D=n("post"),J=n(+p.query.p||1),Q=n(1),K=n(1),X=n(1),Y=n(1),m=n(20),_=n(0),Z=n(0),ee=n(0),se=n(0),ae=n(0),te=n(0),ge=()=>{switch(D.value){case"post":L();break;case"comment":R();break;case"highlight":A();break;case"media":N();break;case"star":V();break}},L=()=>{u.value=!0,O({username:T.value,style:"post",page:o.value,page_size:m.value}).then(e=>{u.value=!1,e.list.length===0&&(v.value=!0),o.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),_.value=Math.ceil(e.pager.total_rows/m.value),U.value=a.value,Z.value=_.value}).catch(e=>{a.value=[],o.value>1&&o.value--,u.value=!1})},R=()=>{u.value=!0,O({username:T.value,style:"comment",page:o.value,page_size:m.value}).then(e=>{u.value=!1,e.list.length===0&&(v.value=!0),o.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),_.value=Math.ceil(e.pager.total_rows/m.value),I.value=a.value,ee.value=_.value}).catch(e=>{a.value=[],o.value>1&&o.value--,u.value=!1})},A=()=>{u.value=!0,O({username:T.value,style:"highlight",page:o.value,page_size:m.value}).then(e=>{u.value=!1,e.list.length===0&&(v.value=!0),o.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),_.value=Math.ceil(e.pager.total_rows/m.value),M.value=a.value,se.value=_.value}).catch(e=>{a.value=[],o.value>1&&o.value--,u.value=!1})},N=()=>{u.value=!0,O({username:T.value,style:"media",page:o.value,page_size:m.value}).then(e=>{u.value=!1,e.list.length===0&&(v.value=!0),o.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),_.value=Math.ceil(e.pager.total_rows/m.value),C.value=a.value,ae.value=_.value}).catch(e=>{a.value=[],o.value>1&&o.value--,u.value=!1})},V=()=>{u.value=!0,O({username:T.value,style:"star",page:o.value,page_size:m.value}).then(e=>{u.value=!1,e.list.length===0&&(v.value=!0),o.value>1?a.value=a.value.concat(e.list):(a.value=e.list||[],window.scrollTo(0,0)),_.value=Math.ceil(e.pager.total_rows/m.value),F.value=a.value,te.value=_.value}).catch(e=>{a.value=[],o.value>1&&o.value--,u.value=!1})},we=e=>{switch(D.value=e,D.value){case"post":a.value=U.value,o.value=J.value,_.value=Z.value,L();break;case"comment":a.value=I.value,o.value=Q.value,_.value=ee.value,R();break;case"highlight":a.value=M.value,o.value=K.value,_.value=se.value,A();break;case"media":a.value=C.value,o.value=X.value,_.value=ae.value,N();break;case"star":a.value=F.value,o.value=Y.value,_.value=te.value,V();break}},S=()=>{l.value=!0,Je({username:T.value}).then(e=>{l.value=!1,s.id=e.id,s.avatar=e.avatar,s.username=e.username,s.nickname=e.nickname,s.is_admin=e.is_admin,s.is_friend=e.is_friend,s.created_on=e.created_on,s.is_following=e.is_following,s.follows=e.follows,s.followings=e.followings,s.status=e.status,ge()}).catch(e=>{l.value=!1,console.log(e)})},ke=()=>{switch(D.value){case"post":J.value=o.value,L();break;case"comment":Q.value=o.value,R();break;case"highlight":K.value=o.value,A();break;case"media":X.value=o.value,N();break;case"star":Y.value=o.value,V();break}},ye=()=>{k.value=!0},be=()=>{x.value=!0},Pe=()=>{k.value=!1},$e=()=>{x.value=!1},z=e=>()=>_e(ue,null,{default:()=>_e(e)}),xe=_s(()=>{let e=[{label:"私信",key:"whisper",icon:z(ys)}];return d.state.userInfo.is_admin&&(s.status===1?e.push({label:"禁言",key:"banned",icon:z(pe)}):e.push({label:"解封",key:"deblocking",icon:z(pe)})),s.is_following?e.push({label:"取消关注",key:"unfollow",icon:z(bs)}):e.push({label:"关注",key:"follow",icon:z(Ps)}),s.is_friend?e.push({label:"删除好友",key:"delete",icon:z($s)}):e.push({label:"添加朋友",key:"requesting",icon:z(xs)}),e}),Te=e=>{switch(e){case"whisper":ye();break;case"delete":ze();break;case"requesting":be();break;case"follow":case"unfollow":Ue();break;case"banned":case"deblocking":Ie();break}},ze=()=>{$.warning({title:"删除好友",content:"将好友 “"+s.nickname+"” 删除，将同时删除 点赞/收藏 列表中关于该朋友的 “好友可见” 推文",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{l.value=!0,Qe({user_id:s.id}).then(e=>{l.value=!1,s.is_friend=!1,L()}).catch(e=>{l.value=!1,console.log(e)})}})},Ue=()=>{$.success({title:"提示",content:"确定"+(s.is_following?"取消关注":"关注")+"该用户吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{l.value=!0,s.is_following?Ke({user_id:s.id}).then(e=>{l.value=!1,window.$message.success("取消关注成功"),S()}).catch(e=>{l.value=!1,console.log(e)}):Xe({user_id:s.id}).then(e=>{l.value=!1,window.$message.success("关注成功"),S()}).catch(e=>{l.value=!1,console.log(e)})}})},Ie=()=>{$.warning({title:"警告",content:"确定对该用户进行"+(s.status===1?"禁言":"解封")+"处理吗？",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{l.value=!0,Ye({id:s.id,status:s.status===1?2:1}).then(e=>{l.value=!1,s.status===1?window.$message.success("禁言成功"):window.$message.success("解封成功"),S()}).catch(e=>{l.value=!1,console.log(e)})}})},Me=()=>{o.value<_.value||_.value==0?(v.value=!1,o.value++,ke()):v.value=!0};return ps(()=>{S()}),vs(()=>({path:p.path,query:p.query}),(e,b)=>{b.path==="/u"&&e.path==="/u"&&(T.value=p.query.s||"",S())}),(e,b)=>{const Ce=ms,Fe=as,H=ts,oe=ds("router-link"),qe=E,Se=os,We=Ms,ne=ns,W=ls,Oe=us,Be=je,De=is,Le=Ve,le=cs,Re=He,Ae=es,Ne=ss;return c(),w("div",null,[t(Ce,{title:"用户详情"}),t(Ae,{class:"main-content-wrap profile-wrap",bordered:""},{default:i(()=>[t(ne,{show:l.value},{default:i(()=>[s.id>0?(c(),w("div",Os,[r("div",Bs,[t(Fe,{size:72,src:s.avatar},null,8,["src"])]),r("div",Ds,[r("div",Ls,[r("strong",null,h(s.nickname),1),r("span",null," @"+h(s.username),1),f(d).state.userInfo.id>0&&f(d).state.userInfo.username!=s.username&&s.is_friend?(c(),y(H,{key:0,class:"top-tag",type:"info",size:"small",round:""},{default:i(()=>[g(" 好友 ")]),_:1})):P("",!0),f(d).state.userInfo.id>0&&f(d).state.userInfo.username!=s.username&&s.is_following?(c(),y(H,{key:1,class:"top-tag",type:"success",size:"small",round:""},{default:i(()=>[g(" 已关注 ")]),_:1})):P("",!0),s.is_admin?(c(),y(H,{key:2,class:"top-tag",type:"error",size:"small",round:""},{default:i(()=>[g(" 管理员 ")]),_:1})):P("",!0)]),r("div",Rs,[r("span",As,"UID. "+h(s.id),1),r("span",Ns,h(f(gs)(s.created_on))+" 加入",1)]),r("div",Vs,[r("span",Hs,[t(oe,{onClick:b[0]||(b[0]=ie(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:s.username,n:s.nickname,t:"follows"}}},{default:i(()=>[g(" 关注  "+h(s.follows),1)]),_:1},8,["to"])]),r("span",js,[t(oe,{onClick:b[1]||(b[1]=ie(()=>{},["stop"])),class:"following-link",to:{name:"following",query:{s:s.username,n:s.nickname,t:"followings"}}},{default:i(()=>[g(" 粉丝  "+h(s.followings),1)]),_:1},8,["to"])])])]),f(d).state.userInfo.id>0&&f(d).state.userInfo.username!=s.username?(c(),w("div",Es,[t(Se,{placement:"bottom-end",trigger:"click",size:"small",options:xe.value,onSelect:Te},{default:i(()=>[t(qe,{quaternary:"",circle:""},{icon:i(()=>[t(f(ue),null,{default:i(()=>[t(f(ks))]),_:1})]),_:1})]),_:1},8,["options"])])):P("",!0)])):P("",!0),t(We,{show:k.value,user:s,onSuccess:Pe},null,8,["show","user"]),t(Ws,{show:x.value,user:s,onSuccess:$e},null,8,["show","user"])]),_:1},8,["show"]),t(Oe,{class:"profile-tabs-wrap",type:"line",animated:"","onUpdate:value":we},{default:i(()=>[t(W,{name:"post",tab:"泡泡"}),t(W,{name:"comment",tab:"评论"}),t(W,{name:"highlight",tab:"亮点"}),t(W,{name:"media",tab:"图文"}),t(W,{name:"star",tab:"喜欢"})]),_:1}),u.value?(c(),w("div",Gs,[t(Be,{num:m.value},null,8,["num"])])):(c(),w("div",Js,[a.value.length===0?(c(),w("div",Qs,[t(De,{size:"large",description:"暂无数据"})])):P("",!0),f(d).state.desktopModelShow?(c(),w("div",Ks,[(c(!0),w(ce,null,re(a.value,q=>(c(),y(le,{key:q.id},{default:i(()=>[t(Le,{post:q},null,8,["post"])]),_:2},1024))),128))])):(c(),w("div",Xs,[(c(!0),w(ce,null,re(a.value,q=>(c(),y(le,{key:q.id},{default:i(()=>[t(Re,{post:q},null,8,["post"])]),_:2},1024))),128))]))]))]),_:1}),_.value>0?(c(),y(Ne,{key:0,justify:"center"},{default:i(()=>[t(f(ws),{class:"load-more",slots:{complete:"没有更多泡泡了",error:"加载出错"},onInfinite:b[2]||(b[2]=q=>Me())},{spinner:i(()=>[r("div",Ys,[v.value?P("",!0):(c(),y(ne,{key:0,size:14})),r("span",Zs,h(v.value?"没有更多泡泡了":"加载更多"),1)])]),_:1})]),_:1})):P("",!0)])}}});const Fa=j(ea,[["__scopeId","data-v-d102b95a"]]);export{Fa as default};
